apiVersion: kpt.dev/v1
kind: FunctionResultList
metadata:
  name: fnresults
exitCode: 1
items:
  - image: ghcr.io/kptdev/krm-functions-catalog/gatekeeper:latest
    exitCode: 0
    results:
      - message: |-
          The following banned keys are being used in the ConfigMap: {"private_key"}
          violatedConstraint: no-secrets-in-configmap
        severity: warning
        resourceRef:
          apiVersion: v1
          kind: ConfigMap
          name: some-secret
          namespace: default
        file:
          path: resources.yaml
          index: 4
      - message: |-
          The following banned keys are being used in the ConfigMap: {"less_sensitive_key"}
          violatedConstraint: no-sensitive-data-in-configmap
        severity: info
        resourceRef:
          apiVersion: v1
          kind: ConfigMap
          name: some-secret
          namespace: default
        file:
          path: resources.yaml
          index: 4
  - image: ghcr.io/kptdev/krm-functions-catalog/kubeconform:latest
    stderr: 'failed to evaluate function: error: function failure'
    exitCode: 1
    results:
      - message: missing properties 'selector', 'template'
        severity: error
        resourceRef:
          apiVersion: apps/v1
          kind: Deployment
          name: nginx-deployment
        field:
          path: spec
        file:
          path: resources.yaml
      - message: got string, want null or integer
        severity: error
        resourceRef:
          apiVersion: apps/v1
          kind: Deployment
          name: nginx-deployment
        field:
          path: spec.replicas
        file:
          path: resources.yaml
